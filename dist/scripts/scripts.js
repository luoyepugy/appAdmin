!function(){"use strict";function e(e,t,n,a){r.controller=n.register,r.directive=t.directive,r.filter=a.register,r.factory=e.factory,r.service=e.service,r.constant=e.constant}e.$inject=["$provide","$compileProvider","$controllerProvider","$filterProvider"];var t={host:"http://192.168.1.154:8083"},r=angular.module("app",["ui.bootstrap","ui.router","oc.lazyLoad"]).config(e).constant("config",t)}(),function(){"use strict";function e(e,t){e.config({debug:!1,events:!1,modules:t})}e.$inject=["$ocLazyLoadProvider","Modules_Config"],angular.module("app").constant("Modules_Config",[]).config(e)}(),function(){"use strict";function e(e,t){t.otherwise("/signin"),e.state("signin",{url:"/signin",templateUrl:"views/signin.html",controller:"signinCtrl",controllerAs:"vm"}).state("admin",{url:"/admin",templateUrl:"views/admin.html",controller:"adminCtrl",controllerAs:"vm"}).state("admin.vip-purchaser",{url:"/vip-purchaser",controller:"vipListCtrl",controllerAs:"vm",cache:!1,templateUrl:"views/vip/purchaser.html"}).state("admin.vip-supplier",{url:"/vip-supplier",controller:"vipListCtrl",controllerAs:"vm",cache:!1,templateUrl:"views/vip/supplier.html"}).state("admin.vip-edit",{url:"/vip-edit/:vipId",templateUrl:"views/vip/edit.html",controller:"vipEditCtrl",controllerAs:"vm"}).state("admin.order-offer",{url:"/order-offer",cache:!1,templateUrl:"views/order/offer.html",controller:"orderListCtrl",controllerAs:"vm"}).state("admin.order-paying",{url:"/order-paying",cache:!1,templateUrl:"views/order/paying.html",controller:"orderListCtrl",controllerAs:"vm"}).state("admin.order-payed",{url:"/order-payed",cache:!1,templateUrl:"views/order/payed.html",controller:"orderListCtrl",controllerAs:"vm"}).state("admin.order-shipped",{url:"/order-shipped",cache:!1,templateUrl:"views/order/shipped.html",controller:"orderListCtrl",controllerAs:"vm"}).state("admin.order-finished",{url:"/order-finished",cache:!1,templateUrl:"views/order/finished.html",controller:"orderListCtrl",controllerAs:"vm"}).state("admin.order-closed",{url:"/order-closed",cache:!1,templateUrl:"views/order/closed.html",controller:"orderListCtrl",controllerAs:"vm"}).state("admin.order-edit",{url:"/order-edit/:orderId",templateUrl:"views/order/edit.html",controller:"orderEditCtrl",controllerAs:"vm"}).state("admin.order-offerList",{url:"/order-offerList/:orderId",templateUrl:"views/order/offer-list.html",controller:"orderOfferListCtrl",controllerAs:"vm"}).state("admin.auth-list",{url:"/auth-list",cache:!1,templateUrl:"views/auth/list.html",controller:"authListCtrl",controllerAs:"vm"}).state("admin.auth-listEdit",{url:"/auth-listEdit/:adminId",templateUrl:"views/auth/list-edit.html",controller:"authListEditCtrl",controllerAs:"vm"}).state("admin.auth-roleDeploy",{url:"/auth-roleDeploy/:adminId/:userName",templateUrl:"views/auth/role-deploy.html",controller:"authRoleDeployCtrl",controllerAs:"vm"}).state("admin.auth-changePwd",{url:"/auth-changePwd/:userName",templateUrl:"views/auth/changePwd.html",controller:"authChangePwdCtrl",controllerAs:"vm"}).state("admin.auth-addAdmin",{url:"/auth-addAdmin",templateUrl:"views/auth/add-admin.html"}).state("admin.auth-role",{url:"/auth-role",cache:!1,templateUrl:"views/auth/role.html",controller:"authRoleCtrl",controllerAs:"vm"}).state("admin.auth-roleEdit",{url:"/auth-roleEdit/:roleId",cache:!1,templateUrl:"views/auth/role-edit.html",controller:"authRoleEditCtrl",controllerAs:"vm"}).state("admin.auth-addRole",{url:"/auth-addRole",templateUrl:"views/auth/add-role.html"}).state("admin.help-about",{url:"/help-about",templateUrl:"views/help/about.html"}).state("admin.help-manual",{url:"/help-manual",templateUrl:"views/help/manual.html"})}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("app").config(e)}(),function(){"use strict";function e(e,t,r,n,a,i){function l(e){13==e.keyCode&&angular.element("#button").trigger("click")}var o=this;o.submit=l}e.$inject=["$scope","validateService","$state","httpService","config","$http"],angular.module("app").controller("signinCtrl",e)}(),function(){"use strict";function e(e,t){function r(){t.getDatas("GET",s+"/getMenuList/"+o.userName).then(function(e){o.menuList=n(e.data)})}function n(e){for(var t=[],r={title:"会员管理",isOpen:!0,childMenu:[]},n={title:"订单管理",isOpen:!0,childMenu:[]},a={title:"权限管理",isOpen:!0,childMenu:[]},i={title:"帮助",isOpen:!0,childMenu:[]},l=0;l<e.length;l++)switch(e[l]){case"11":r.childMenu.push({title:"采购商列表",state:"admin.vip-purchaser",id:11});break;case"12":r.childMenu.push({title:"供应商列表",state:"admin.vip-supplier",id:12});break;case"21":n.childMenu.push({title:"报价列表",state:"admin.order-offer",id:21});break;case"22":n.childMenu.push({title:"待支付列表",state:"admin.order-paying",id:22});break;case"23":n.childMenu.push({title:"已支付列表",state:"admin.order-payed",id:23});break;case"24":n.childMenu.push({title:"已发货列表",state:"admin.order-shipped",id:24});break;case"25":n.childMenu.push({title:"已完成列表",state:"admin.order-finished",id:25});break;case"26":n.childMenu.push({title:"已关闭列表",state:"admin.order-closed",id:26});break;case"31":a.childMenu.push({title:"管理员列表",state:"admin.auth-list",id:31});break;case"32":a.childMenu.push({title:"角色列表",state:"admin.auth-role",id:32});break;case"41":i.childMenu.push({title:"关于",state:"admin.help-about",id:41});break;case"42":i.childMenu.push({title:"手册",state:"admin.help-manual",id:42})}var o={vip:r,order:n,auth:a,help:i};for(l in o)o[l].childMenu.length>0&&t.push(o[l]);return t}function a(e){o.menuList.length;o.menuList[e].isOpen=!o.menuList[e].isOpen}function i(e){Number(e)!=c?(o.flag[e]=!0,o.flag[c]=!1,c=Number(e)):o.flag[c]=!0}function l(){window.localStorage.clear(),e.go("signin")}var o=this,s="/backend/admin",c=11;o.flag={},o.isOpen=!1,o.signout=l,o.menu=a,o.childMenu=i,o.userName=window.localStorage.getItem("userName"),r()}e.$inject=["$state","httpService"],angular.module("app").controller("adminCtrl",e)}(),function(){"use strict";function e(e){function t(){e.getDatas("GET",a+"/findAll").then(function(e){n.vipList=e.data})}function r(){console.log("page"+n.pagination.bigCurrentPage)}var n=this,a="/backend/user";n.pageChange=r,n.pagination={maxSize:5,bigTotalItems:15,bigCurrentPage:1},t()}e.$inject=["httpService"],angular.module("app").controller("vipListCtrl",e)}(),function(){"use strict";function e(e,t){function r(){e.getDatas("GET",a+"/getById/"+i).then(function(e){n.vipDetail=e.data})}var n=this,a="/backend/user",i=t.vipId;n.vipDetail={},r()}e.$inject=["httpService","$stateParams"],angular.module("app").controller("vipEditCtrl",e)}(),function(){"use strict";function e(e){function t(){e.getDatas("GET",a+"/findAll").then(function(e){n.authList=e.data})}function r(){e.getDatas("GET",a+"/creat").then(function(e){n.authList=e.data})}var n=this,a="/backend/admin";n.addAdmin=r,t()}e.$inject=["httpService"],angular.module("app").controller("authListCtrl",e)}(),function(){"use strict";function e(e,t){function r(){e.getDatas("GET",a+"/getCompletelyInfos/"+i).then(function(e){n.authListDetail=e.data})}var n=this,a="/backend/admin",i=t.adminId;r()}e.$inject=["httpService","$stateParams"],angular.module("app").controller("authListEditCtrl",e)}(),function(){"use strict";function e(e,t){function r(){e.getDatas("GET",a+"/findAll").then(function(e){n.authRoleList=e.data})}var n=this,a="/backend/role";r()}e.$inject=["httpService","messageService"],angular.module("app").controller("authRoleCtrl",e)}(),function(){"use strict";function e(e){function t(){e.getDatas("GET",n+"/creat").then(function(e){r.authList=e.data})}var r=this,n="/backend/admin";r.addAdmin=t}e.$inject=["httpService"],angular.module("app").controller("authAddAdminCtrl",e)}(),function(){"use strict";function e(e){var t=this;t.userName=e.userName}e.$inject=["$stateParams"],angular.module("app").controller("authChangePwdCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){e.getDatas("GET",c+"/findOne/"+u).then(function(e){var t=e.data,r=t.interfaceList.length,n=t.menuList.length;s.roleDetail=t;for(var a=0;r>a;a++)s.checkedInterfaces[t.interfaceList[a]]=!0;r==s.interfaceList.length&&(s.allInterface=!0);for(var i=0;n>i;i++)s.checkedMenus[t.menuList[i]]=!0;n==s.menuList.length&&(s.allMenu=!0)}),e.getDatas("GET","/backend/access/getAllInterfaces").then(function(e){s.interfaceList=e.data})}function a(e){for(var t in s.interfaceList)s.checkedInterfaces[s.interfaceList[t].route]=e}function i(e){for(var t in s.menuList)s.checkedMenus[s.menuList[t].id]=e}function l(){d=[];for(var t in s.checkedInterfaces)s.checkedInterfaces[t]&&d.push(t);e.getDatas("POST",c+"/setInterfaceList",{id:u,interfaceList:d}).then(function(e){r.show("接口权限修改成功",!0)})}function o(){h=[];for(var t in s.checkedMenus)s.checkedMenus[t]&&h.push(t);e.getDatas("POST",c+"/setMenuList",{id:u,menuList:h}).then(function(e){r.show("菜单权限修改成功",!0)})}var s=this,c="/backend/role",u=t.roleId,d=[],h=[];s.checkedInterfaces={},s.checkedMenus={},s.allMenu=!1,s.allInterface=!1,s.interfaceList=[],s.menuList=[{name:"会员管理 / 采购商列表",id:11},{name:"会员管理 / 供应商列表",id:12},{name:"订单管理 / 报价列表",id:21},{name:"订单管理 / 待支付列表",id:22},{name:"订单管理 / 已支付列表",id:23},{name:"订单管理 / 已发货列表",id:24},{name:"订单管理 / 已完成列表",id:25},{name:"订单管理 / 已关闭列表",id:26},{name:"权限管理 / 管理员列表",id:31},{name:"权限管理 / 角色列表",id:32},{name:"帮助 / 关于",id:41},{name:"帮助 / 手册",id:42}],s.setInterface=l,s.setMenu=o,s.checkedAllInterface=a,s.checkedAllMenu=i,n()}e.$inject=["httpService","$stateParams","messageService"],angular.module("app").controller("authRoleEditCtrl",e)}(),function(){"use strict";function e(e,t,r){function n(){e.getDatas("GET",l+"/findAll").then(function(e){i.authRoleDeploy=e.data}),e.getDatas("GET",o+"/getCompletelyInfos/"+s).then(function(e){for(var t=e.data,r=t.role.length,n=0;r>n;n++)i.checkedRole[t.role[n]._id]=!0})}function a(){var r=[];for(var n in i.checkedRole)i.checkedRole[n]&&r.push(n);e.getDatas("POST","/backend/adminRole/upsert",{adminId:s,roles:r}).then(function(e){t.go("admin.auth-list")})}var i=this,l="/backend/role",o="/backend/admin",s=r.adminId;i.checkedRole={},i.deployRole=a,n()}e.$inject=["httpService","$state","$stateParams"],angular.module("app").controller("authRoleDeployCtrl",e)}(),function(){"use strict";function e(e){function t(){e.getDatas("GET",n+"/findOrders").then(function(e){r.orderList=e.data})}var r=this,n="/backend/order";t()}e.$inject=["httpService"],angular.module("app").controller("orderListCtrl",e)}(),function(){"use strict";function e(e,t){function r(){e.getDatas("GET",a+"/getOrder/"+i).then(function(e){n.orderDetail=e.data,"报价"==n.orderDetail.state?n.orderDetail.stateSets=[{value:"报价"},{value:"已关闭"}]:"已发货"==n.orderDetail.state?n.orderDetail.stateSets=[{value:"已发货"},{value:"已完成"}]:"待支付"==n.orderDetail.state?n.orderDetail.stateSets=[{value:"待支付"},{value:"已关闭"}]:n.orderDetail.stateSets=[{value:n.orderDetail.state}],n.orderDetail.state=n.orderDetail.stateSets[0]})}var n=this,a="/backend/order",i=t.orderId;n.orderDetail={},r()}e.$inject=["httpService","$stateParams"],angular.module("app").controller("orderEditCtrl",e)}(),function(){"use strict";function e(e,t,r,n){function a(){e.getDatas("GET",o+"/getQuotations/"+s).then(function(e){l.orderOfferList=e.data})}function i(n,a){var i=t.open({animation:!0,templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",size:"sm"});i.result.then(function(){e.getDatas("POST",o+"/removeQuotation",{quotationId:n}).then(function(){l.orderOfferList.splice(a,1)})},function(){r.info("Modal dismissed at: "+new Date)})}var l=this,o="/backend/order",s=n.orderId;l.deleteOffer=i,a()}function t(e,t){function r(){e.close("deleteOk")}function n(){e.dismiss("deleteCancel")}t.deleteOk=r,t.deleteCancel=n}e.$inject=["httpService","$uibModal","$log","$stateParams"],t.$inject=["$uibModalInstance","$scope"],angular.module("app").controller("orderOfferListCtrl",e),angular.module("app").controller("ModalInstanceCtrl",t)}(),function(){"use strict";function e(){return function(e){switch(e){case"报价":return!0;default:return!1}}}angular.module("app").filter("offerShow",e)}(),function(){"use strict";function e(e,t){function r(e,r){var n=r||!1;$(".alert").length<1&&(n?$(".messageBox").prepend('<div class="alert alert-success" role="alert">'+e+"</div>"):$(".messageBox").prepend('<div class="alert alert-danger" role="alert">'+e+"</div>"),t(function(){$(".alert").remove()},3e3))}var n={show:r};return n}e.$inject=["$rootScope","$timeout"],angular.module("app").factory("messageService",e)}(),function(){"use strict";function e(e){function t(t){var r=0,n=$(t).find(".j-input").length,a="";return $(t).find(".j-input").each(function(){var t=($(this).attr("name"),$.trim($(this).val()));return""==t||null==t?(a=$(this).data("empty"),e.show(a),!1):void r++}),r===n}function r(t){var r={},n=/^((145|147)|(15[^4])|(17[6-8])|((13|18)[0-9]))\d{8}$/;return $(t).find("input[name],textarea[name],select[name]").each(function(){var e=$(this).attr("name"),t=$.trim($(this).val());r[e]=t}),null!=r.company&&""!=r.company&&(r.userProfile={company:r.company}),null!=r.ifAuditPass&&""!=r.ifAuditPass&&("true"==r.ifAuditPass?r.ifAuditPass=!0:"false"==r.ifAuditPass&&(r.ifAuditPass=!1)),null!=r.isLockout&&""!=r.isLockout&&("true"==r.isLockout?r.isLockout=!0:"false"==r.isLockout&&(r.isLockout=!1)),null!=r.phone&&n.test(r.phone)===!1?(e.show("请输入正确的手机号码格式"),!1):null!=r.confirmPwd&&r.confirmPwd!==r.password?(e.show("两次密码输入不一致"),!1):null!=r.productAmount&&isNaN(r.productAmount)===!0||Number(r.productAmount)<=0?(e.show("请输入正确的商品数量格式"),!1):r}var n={isEmpty:t,submitData:r};return n}e.$inject=["messageService"],angular.module("app").factory("validateService",e)}(),function(){"use strict";function e(e,t,r,n,a){function i(i,l,o){var s,c=e.defer(),u=a.host,d="";if(null!=window.localStorage.getItem("token")&&""!==window.localStorage.getItem("token")&&(d=window.localStorage.getItem("token")),"POST"===i)s={method:"POST",url:u+l,headers:{"x-app-version":"0.0.1","x-access-token":d},data:o};else if("GET"===i){var h=u+l;if(null!=o&&""!=o)for(var m in o)h+="/"+o[m];s={method:"GET",url:h,headers:{"x-app-version":"0.0.1","x-access-token":d}}}return t(s).success(function(e,t){e.status?c.resolve(e):null!=e.errMsg&&""!==e.errMsg&&r.show(e.errMsg)}).error(function(e,t){console.log(t),401===t?n.go("signin"):403===t||r.show("服务器请求失败")}),c.promise}return{getDatas:i}}e.$inject=["$q","$http","messageService","$state","config"],angular.module("app").factory("httpService",e)}(),function(){"use strict";function e(e,t,r,n,a,i){function l(t,i,l){t.text=l.text||"提交保存";var o,s,c=l.state||"",u=(l.user||"",l.login||"");i.bind("click",function(){if(o=r.isEmpty(l.form),!o)return!1;if(s=r.submitData(l.form)){var t=l.method||"POST";e.getDatas(t,"/backend"+l.action,s).then(function(e){"back"==c?a.history.back():n.go(c),"true"===u&&(a.localStorage.token=e.token,window.localStorage.userName=s.userName)})}})}var o={restrict:"E",template:'<button name="submitBtn" class="btn btn-default">{{text}}</button>',replace:!0,scope:{},link:l};return o}e.$inject=["httpService","messageService","validateService","$state","$window","$rootScope"],angular.module("app").directive("submitButton",e)}(),function(){"use strict";function e(e){function t(t,r,n){r.bind("click",function(){e.history.back()})}var r={restrict:"AE",link:t};return r}e.$inject=["$window"],angular.module("app").directive("backButton",e)}();